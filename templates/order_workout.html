<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Place Workout Order</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='order.css') }}">
  <link rel="icon" href="{{ url_for('static', filename='logo.png') }}" type="image/x-icon">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { overflow-x: hidden; }

    .workout-group,
    .combo-group {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      align-items: flex-start;
      margin-bottom: 15px;
    }
    .workout-group label,
    .combo-group label {
      flex: 1 1 100%;
      margin-bottom: 5px;
    }
    .workout-group select,
    .workout-group input[type="number"],
    .combo-group select,
    .combo-group input[type="number"] {
      flex: 1;
      min-width: 0;
    }

    /* NEW: remove button */
    .remove-btn {
      background: #ffffffff;
      color: white;
      border: none;
      margin-top:4px;
      padding: 6px 10px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }
    label,input,small{
      font-family: 'Adieu', sans-serif;
    }
    .div{
      margin-bottom:100px !important;
    }
     @media (max-width: 480px) {
      .choose {
        font-size: 12px !important;
      }
      small {
        font-size: 8px !important;
        display: block;
        margin-top: -4px !important;
      }

      .redeem-label {
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .redeem-checkbox {
        transform: scale(0.7);
        margin: 0 !important;
      }

      .redeem-text {
        font-size: 10px;
        line-height: 1;
      }
      .div{
        margin-bottom:100px;
      }

  }
  </style>
</head>
<body>

<nav class="navbar">
  <div class="mobile-header">
    <button id="hamburger" class="hamburger" aria-label="Toggle menu" aria-expanded="false">â˜°</button>
    <span class="mobile-title">WHEY-ON-WHEELS</span>

    {% if session.get('user') %}
      <a href="/profile" class="mobile-profile">ðŸ‘¤</a>
    {% endif %}
  </div>

  <div class="navbar-container desktop-nav">
    <div class="nav-left">
      <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/menu_select">Menu</a></li>
        <li><a href="/order_select">Order</a></li>
      </ul>
    </div>

    <div class="nav-right">
      <ul>
        <li><a href="#" id="scroll-about">About Us</a></li>
        <li><a href="#" id="contact-link">Contact Us</a></li>
        {% if session.get('user') %}
          <li><a href="/profile">ðŸ‘¤</a></li>
          <li><a href="/logout">Logout</a></li>
        {% else %}
          <li><a href="/login">Login</a></li>
        {% endif %}
      </ul>
    </div>
  </div>

  <div id="mobile-menu" class="mobile-menu" aria-hidden="true">
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="/menu_select">Menu</a></li>
      <li><a href="/order_select">Order</a></li>
      <li><a href="#" id="mobile-about">About Us</a></li>
      <li><a href="#" id="mobile-contact">Contact Us</a></li>
      {% if session.get('user') %}
        <li><a href="/profile">ðŸ‘¤ Profile</a></li>
        <li><a href="/logout">Logout</a></li>
      {% else %}
        <li><a href="/login">Login</a></li>
      {% endif %}
    </ul>
  </div>
</nav>

<div class="form-container">
  <h2>Place Your Workout Order</h2>
  <form method="POST" action="/order_workout" id="orderForm">

    <div id="workoutContainer">
      <div class="workout-group">
        <label>Choose a Workout Drink and Quantity:</label>

        <select name="workout[]" class="workout">
          <option value="">None</option>
          {% for item in workouts %}
            <option value="{{ item }}">{{ item }}</option>
          {% endfor %}
        </select>

        <input type="number" name="quantity[]" min="1" value="1">

        <select name="addon[]" class="addon">
          <option value="">No Addon</option>
          {% for item in addons %}
            <option value="{{ item }}">{{ item }}</option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div class="add-button" onclick="addWorkout(); calculateTotal();">âž• Add Another Workout Drink</div>

    <div class="combo-group">
      <label class="choose">Choose a Combo, Quantity & Addon:</label>

      <select name="combo" id="combo">
        <option value="">None</option>
        {% for item in combos %}
          <option value="{{ item }}">{{ item }}</option>
        {% endfor %}
      </select>

      <input type="number" name="combo_quantity" id="combo_quantity" min="1" value="1">

      <select name="combo_addon" id="combo_addon">
        <option value="">No Addon</option>
        {% for item in addons %}
          <option value="{{ item }}">{{ item }}</option>
        {% endfor %}
      </select>
    </div>

    <label class="redeem-label">
      <input type="checkbox" name="useRewards" id="redeem_toggle" class="redeem-checkbox">
      <span class="redeem-text">Redeem all reward points</span>
    </label>
    
    <input type="hidden" name="redeem_points" id="redeem_points" value="0" data-max="{{ user_rewards }}">
    <small>You have {{ user_rewards }} reward points</small>

    <div style="margin: 20px 0; font-weight: bold; font-size: 1em;">
      Total Bill: â‚¹<span id="totalPrice">0</span>
    </div>

    <div id="discountNote" style="display:none; color: green; margin-top: -10px;">
      ðŸŽ‰ 10% discount applied (2 or more items)
    </div>

    <button type="submit" style="color:#000000;">Place Order</button>
  </form>
</div>
<div class="div"></div>

<!-- Confetti JS -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const elements = document.querySelectorAll(".about-startup, .features");
  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      entry.target.classList.toggle("animate-in", entry.isIntersecting);
    });
  }, { threshold: 0.3 });
  elements.forEach((el) => observer.observe(el));
});

function updateAddonState(group) {
  const smoothieSel = group.querySelector("select.smoothie");
  const addonSelects = group.querySelectorAll("select.addon");
  if (!smoothieSel) return;
  addonSelects.forEach((addonSel) => {
    if (!smoothieSel.value) {
      addonSel.value = "";
      addonSel.disabled = true;
      addonSel.style.opacity = "0.5";
    } else {
      addonSel.disabled = false;
      addonSel.style.opacity = "1";
    }
  });
}

document.addEventListener("DOMContentLoaded", () => {
  const url = new URL(window.location.href);
  if (url.searchParams.get("smoothie")) {
    document.querySelector(".form-container").scrollIntoView({ behavior: "smooth" });
  }
});

function launchConfetti() {
  const duration = 3000;
  const end = Date.now() + duration;
  (function frame() {
    confetti({ particleCount: 6, angle: 60, spread: 55, origin: { x: 0 } });
    confetti({ particleCount: 6, angle: 120, spread: 55, origin: { x: 1 } });
    if (Date.now() < end) requestAnimationFrame(frame);
  })();
}
</script>


<script>
/* Data */
const prices = {{ prices | tojson }};
const workouts = {{ workouts | tojson }};
const addons = {{ addons | tojson }};
const combos = {{ combos | tojson }};

/* Normalize helper */
function normalize(s){ return (s||'').toString().trim().toLowerCase(); }

/* REMOVE WORKOUT ROW */
function removeWorkout(btn){
  btn.parentElement.remove();
  calculateTotal();
}

/* Add another workout row */
function addWorkout(){
  const container = document.getElementById("workoutContainer");
  const row = document.createElement("div");
  row.className = "workout-group";

  row.innerHTML = `
    <label>Choose a Workout Drink and Quantity:</label>
    <select name="workout[]" class="workout">
      <option value="">None</option>
      ${workouts.map(w => `<option value="${w}">${w}</option>`).join('')}
    </select>
    <input type="number" name="quantity[]" min="1" value="1">
    <select name="addon[]" class="addon">
      <option value="">No Addon</option>
      ${addons.map(a => `<option value="${a}">${a}</option>`).join('')}
    </select>
    <button type="button" class="remove-btn" onclick="removeWorkout(this)">âž–</button>
  `;

  container.appendChild(row);

  row.querySelectorAll("select,input").forEach(el=>{
    el.addEventListener("change", calculateTotal);
    el.addEventListener("input", calculateTotal);
  });

  calculateTotal();
}

/* Total Calculator */
function calculateTotal(){
  let total = 0;
  let totalItems = 0;

  document.querySelectorAll(".workout-group").forEach(group=>{
    const workout = group.querySelector("select.workout")?.value;
    const qty = parseInt(group.querySelector("input")?.value) || 1;
    const addon = group.querySelector("select.addon")?.value;

    const wk = workout ? Object.keys(prices).find(k => normalize(k) === normalize(workout)) : null;
    if(wk){
      total += parseFloat(prices[wk]) * qty;
      totalItems += qty;
    }

    const ak = addon ? Object.keys(prices).find(k => normalize(k) === normalize(addon)) : null;
    if(ak){
      total += parseFloat(prices[ak]) * qty;
    }
  });

  const combo = document.getElementById("combo")?.value;
  const comboQty = parseInt(document.getElementById("combo_quantity")?.value) || 1;
  const comboAddon = document.getElementById("combo_addon")?.value;

  const ck = combo ? Object.keys(prices).find(k => normalize(k) === normalize(combo)) : null;
  if(ck){
    total += parseFloat(prices[ck]) * comboQty;
    totalItems += comboQty;
  }

  const cak = comboAddon ? Object.keys(prices).find(k => normalize(k) === normalize(comboAddon)) : null;
  if(cak){
    total += parseFloat(prices[cak]) * comboQty;
  }

  if(totalItems >= 2){
    total *= 0.90;
    document.getElementById("discountNote").style.display = "block";
  } else {
    document.getElementById("discountNote").style.display = "none";
  }

  const redeemToggle = document.getElementById("redeem_toggle");
  const redeemInput = document.getElementById("redeem_points");

  if(redeemToggle?.checked){
    const max = parseInt(redeemInput.dataset.max) || 0;
    redeemInput.value = max;
    total -= max;
  } else {
    redeemInput.value = 0;
  }

  if(total < 0) total = 0;
  document.getElementById("totalPrice").textContent = total.toFixed(2);
}

document.addEventListener("DOMContentLoaded", ()=>{
  document.querySelectorAll("select,input").forEach(el=>{
    el.addEventListener("change", calculateTotal);
    el.addEventListener("input", calculateTotal);
  });
  calculateTotal();
});
</script>
<script>
  // Animate on scroll
  document.addEventListener("DOMContentLoaded", function () {
    const elements = document.querySelectorAll(".about-startup, .features");

    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add("animate-in");
        } else {
          entry.target.classList.remove("animate-in");
        }
      });
    }, {
      threshold: 0.3
    });

    elements.forEach(el => observer.observe(el));
  });

  // Smooth scroll to About section
  document.getElementById("scroll-about").addEventListener("click", function (e) {
    e.preventDefault();
    window.scrollTo({ top: 750, behavior: 'smooth' });
  });

  // Contact email popup
  document.addEventListener("DOMContentLoaded", function () {
    const contactLink = document.getElementById("contact-link");
    if (contactLink) {
      contactLink.addEventListener("click", function (e) {
        e.preventDefault();
        alert("You can reach us at: wheyonwheels@gmail.com");
        window.location.href = "mailto:wheyonwheels@gmail.com";
      });
    }
  });
  document.addEventListener("DOMContentLoaded", function () {
  const btn = document.getElementById("show-more-btn");
  if (btn) {
    btn.addEventListener("click", function () {
      document.querySelectorAll(".hidden-review").forEach(el => {
        el.style.display = "block";
      });
      btn.style.display = "none"; // hide button after showing all
    });
  }
});
document.addEventListener('DOMContentLoaded', () => {
    const hamburger = document.getElementById('hamburger');
    const navLinks = document.getElementById('nav-links');

    hamburger.addEventListener('click', () => {
      navLinks.classList.toggle('active');
    });
  });
document.addEventListener('DOMContentLoaded', function () {
  const hamburger = document.getElementById('hamburger');
  const mobileMenu = document.getElementById('mobile-menu');

  if (!hamburger || !mobileMenu) return;

  hamburger.addEventListener('click', function () {
    const open = mobileMenu.classList.toggle('open');
    hamburger.classList.toggle('active', open); // âœ… adds animation toggle
    mobileMenu.setAttribute('aria-hidden', !open);
    hamburger.setAttribute('aria-expanded', open);
  });

  // Close menu when clicking a link inside it
  mobileMenu.querySelectorAll('a').forEach(a => {
    a.addEventListener('click', () => {
      mobileMenu.classList.remove('open');
      hamburger.classList.remove('active'); // âœ… reset animation
      mobileMenu.setAttribute('aria-hidden', 'true');
      hamburger.setAttribute('aria-expanded', 'false');
    });
  });

  // Close on Escape key
  document.addEventListener('keydown', e => {
    if (e.key === 'Escape') {
      mobileMenu.classList.remove('open');
      hamburger.classList.remove('active'); // âœ… reset animation
      mobileMenu.setAttribute('aria-hidden', 'true');
      hamburger.setAttribute('aria-expanded', 'false');
    }
  });
});

</script>


<footer class="site-footer">
  <div class="footer-container">
    <div class="footer-section about">
      <h3>WheyOnWheels</h3>
      <p>Your everyday healthy smoothie partner â€” fresh, nutritious, and delivered with care.</p>
    </div>

    <div class="footer-section contact">
      <h4>Contact Us</h4>
      <p>Email: <a href="mailto:wheyonwheelsmumbai@gmail.com">wheyonwheelsmumbai@gmail.com</a></p>
      <p>Location: Mumbai, India</p>
    </div>

    <div class="footer-section social">
      <h4>Follow Us</h4>
      <div class="social-links">
        <a href="https://instagram.com/whey_on_wheels" target="_blank">Instagram</a>
      </div>
    </div>
  </div>

  <p class="footer-bottom">&copy; 2025 WheyOnWheels â€¢ All Rights Reserved</p>
</footer>

</body>
</html>



